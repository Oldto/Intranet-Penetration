# 内网渗透
## 渗透测试的流程
在对内网进行渗透测试前，我们需要获取权限，依次为后台权限=》webshell权限=》服务器权限；大多数情况下是获取到webshell权限，随后再进行提权操作获取服务器权限。
## webshell
#### webshell的定义：对web应用中的文件拥有增删改查的功能。
#### webshell权限
webshell的权限根据不同的系统有的不同的权限，有的时候是系统权限，有的时候是管理员权限，有的时候是普通用户权限。
- Windows
1. system         系统权限      （system权限是最高权限）
2. Administrator  管理员权限
3. user           普通权限
- Linux
1. root           管理员权限
2. user           普通权限

##### 内网需要对计算机不同的系统有着一定的操作能力。
## Windows系统基础篇
- 在Windows服务器中默认只允许拥有管理员权限的用户才能远程登陆服务器中。
- Windows的服务器系统版本（win2000,win2003,win2008,win2012,win2016,win2019,win2022）,都有共同的默认账号administrator和guest，且guest账号默认是禁用的。
- Windows默认远程控制（RDP）端口为3389，服务（TermService）
#### 如何通过命令行锁定端口号
有的时候远程的端口会被管理员修改，我们可以通过命令行来对端口进行锁定，步骤如下：
1. 使用`tasklist /svc`找到TermService服务对应的PID号
2. `netstat -ano`找到对应PID开放的端口号

#### 连接不上3389端口的原因
- 对方服务器只映射了web端口到外网，未映射3389端口到外网，所以外网无法直接访问内网的3389，导致无法连接；可通过ipconfig查看系统是公网IP还是公网IP。
- 服务器自身的系统防火墙入网规则未允许3389入网请求。解决方法：使用dos命令关闭防火墙，简单暴力。

## doc命令篇
```
netsh firewall set opmode disable 关闭防火墙
netsh firewall set opmode mode=enable 开启防火墙
whoami /priv  查看当前权限列表
net user 查看用户列表
net user aaa 查看用户aaa
net user aaa 123  修改用户aaa密码为123
net user aaa /del 删除用户aaa
net user aaa 123 /add 添加用户aaa并且密码为123
net user aaa /active:yes  激活用户aaa
net user aaa /active:no   禁用用户aaa
net localgroup Administrators aaa /add 用户aaa添加到管理员组
net localgroup Administrators aaa /del 将用户aaa从管理员组移除
net localgroup Administrators  查看管理员组有哪些用户
tasklist /svc 查看进程所对应的服务名和PID
tasklist /v 查看进程对应启动的用户名
netstat -ano 查看开放的端口
```
## 权限提升
权限提升分为两类，一类是系统漏洞提权，一类是不正确配置提权，也称第三方提权（sql server提权）。










