# 内网渗透之获取用户密码
获取到用户密码需要我们权限是最高权限，普通权限是不行的。两种思路，一种是获取的加密密码，然后将加密的密码拿到cmd5去解密，这种方法解不开就凉凉。另一种方法可获取明文密码。
## 方法一：获取加密的密码
通过注册表导出文件sam.hiv和sys.hiv
#### 命令
`reg save hklm\sam.hiv`导出sam文件

`reg save hklm\sys.hiv`导出sys文件

#### 在Windows2003版本以上（包含2003）都可以使用此命令，在2003版本中密码以ltml形式存在，其他版本都是以Hash加密


导出之后我们将文件下载，随后通过mimikatz读取文件中内容







## 方法二：获取明文密码
1. 任务管理器导出lsass.exe内存
2. procdump程序lsass内存

###  注意事项：在Windows2012 （包括2012）以上版本无法从lsass。exe内存中窃取明文密码，在Windows2003获取的文件，必须要在同类型的系统中解密，当目标值x86的系统，那么mimikatz也必须是x86的。

## 我们要记录Windows2012的明文密码该如何操作？
需要修改注册表

`reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\ /v UseLogonCredential /t REG_DWORD /d 1`
